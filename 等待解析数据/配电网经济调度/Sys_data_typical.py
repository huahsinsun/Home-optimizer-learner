import numpy as np

# 定义一个类似MATLAB中struct的类
class Struct:
    pass

# 定义成本参数(单位:元/kW)
WT_cost, Solar_cost, RES_cost = 60000, 20000, 5000  

# 创建电力系统结构体
mpc = Struct()
mpc.baseMVA, baseMVA = 100, 100  # 基准容量(MVA)

# 母线数据矩阵 [编号,类型,有功负荷,无功负荷,...]
mpc.bus = np.array([[1, 3, 0, 0, 0, 0, 1, 1, 0, 12.66, 1, 1, 1],
                    [2, 1, 100, 60, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [3, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [4, 1, 120, 80, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [5, 1, 60, 30, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [6, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [7, 1, 200, 100, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [8, 1, 200, 100, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [9, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [10, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [11, 1, 45, 30, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [12, 1, 60, 35, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [13, 1, 60, 35, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [14, 1, 120, 80, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [15, 1, 60, 10, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [16, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [17, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [18, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [19, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [20, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [21, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [22, 1, 90, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [23, 1, 90, 50, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [24, 1, 420, 200, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [25, 1, 420, 200, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [26, 1, 60, 25, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [27, 1, 60, 25, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [28, 1, 60, 20, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [29, 1, 120, 70, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [30, 1, 200, 600, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [31, 1, 150, 70, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [32, 1, 210, 100, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9],
                    [33, 1, 60, 40, 0, 0, 1, 1, 0, 12.66, 1, 1.1, 0.9]])

# 支路数据矩阵 [首端节点,末端节点,电阻,电抗,...]
mpc.branch = np.array([[1, 2, 0.0922, 0.0470, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [2, 3, 0.4930, 0.2511, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [3, 4, 0.3660, 0.1864, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [4, 5, 0.3811, 0.1941, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [5, 6, 0.8190, 0.7070, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [6, 7, 0.1872, 0.6188, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [7, 8, 0.7114, 0.2351, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [8, 9, 1.0300, 0.7400, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [9, 10, 1.0440, 0.7400, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [10, 11, 0.1966, 0.0650, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [11, 12, 0.3744, 0.1238, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [12, 13, 1.4680, 1.1550, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [13, 14, 0.5416, 0.7129, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [14, 15, 0.5910, 0.5260, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [15, 16, 0.7463, 0.5450, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [16, 17, 1.2890, 1.7210, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [17, 18, 0.7320, 0.5740, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [2, 19, 0.1640, 0.1565, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [19, 20, 1.5042, 1.3554, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [20, 21, 0.4095, 0.4784, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [21, 22, 0.7089, 0.9373, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [3, 23, 0.4512, 0.3083, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [23, 24, 0.8980, 0.7091, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [24, 25, 0.8960, 0.7011, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [6, 26, 0.2030, 0.1034, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [26, 27, 0.2842, 0.1447, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [27, 28, 1.0590, 0.9337, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [28, 29, 0.8042, 0.7006, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [29, 30, 0.5075, 0.2585, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [30, 31, 0.9744, 0.9630, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [31, 32, 0.3105, 0.3619, 0, 0, 0, 0, 0, 0, 1, -360, 360],
                       [32, 33, 0.3410, 0.5302, 0, 0, 0, 0, 0, 0, 1, -360, 360]])

# 基准电压和功率
BASE_KV = 10 - 1
BR_R = 3 - 1  # Python索引从0开始,MATLAB从1开始
BR_X = 4 - 1
PD = 3 - 1
QD = 4 - 1
Vbase = mpc.bus[0, BASE_KV] * 1000
Sbase = mpc.baseMVA * 1e6

# 标幺化处理
mpc.branch[:, [BR_R, BR_X]] = mpc.branch[:, [BR_R, BR_X]] / (Vbase ** 2 / Sbase)
mpc.bus[:, [PD, QD]] = mpc.bus[:, [PD, QD]] / 1e3

# 获取系统基本信息
bus = mpc.bus
branch = mpc.branch
Bus_Number = bus.shape[0]
Branch_Number = branch.shape[0]

# 构建支路阻抗矩阵
branch_r_x = np.zeros((branch.shape[0], 4))
branch_r_x[:, [0, 1]] = branch[:, [0, 1]]
branch_r_x[:, 2] = branch[:, 2] * 1
branch_r_x[:, 3] = branch[:, 3] * 1
Rij_matrix = np.full((Bus_Number, Bus_Number), np.inf)
Xij_matrix = np.full((Bus_Number, Bus_Number), np.inf)

# 填充阻抗矩阵
for i in range(Branch_Number):
    Rij_matrix[branch_r_x[i, 0].astype(int) - 1, branch_r_x[i, 1].astype(int) - 1] = branch_r_x[i, 2]
    Rij_matrix[branch_r_x[i, 1].astype(int) - 1, branch_r_x[i, 0].astype(int) - 1] = branch_r_x[i, 2]
    Xij_matrix[branch_r_x[i, 0].astype(int) - 1, branch_r_x[i, 1].astype(int) - 1] = branch_r_x[i, 3]
    Xij_matrix[branch_r_x[i, 1].astype(int) - 1, branch_r_x[i, 0].astype(int) - 1] = branch_r_x[i, 3]

Rij_matrix = Rij_matrix / 1
Xij_matrix = Xij_matrix / 1

# 初始化潮流计算矩阵
Y_po, Y_pv = np.zeros((Bus_Number, Bus_Number)), np.zeros((Bus_Number, Bus_Number))
Y_qo, Y_qv = np.zeros((Bus_Number, Bus_Number)), np.zeros((Bus_Number, Bus_Number))

# 计算潮流矩阵元素
for i in range(Bus_Number):
    for j in range(Bus_Number):
        if j != i:
            if Rij_matrix[i, j] < 10000:  # 小于无穷大
                k = Rij_matrix[i, j] ** 2 + Xij_matrix[i, j] ** 2
                Y_po[i, j] = -Xij_matrix[i, j] / k
                Y_pv[i, j] = -Rij_matrix[i, j] / k
                Y_qo[i, j] = +Rij_matrix[i, j] / k
                Y_qv[i, j] = -Xij_matrix[i, j] / k

# 计算对角线元素
for i in range(Bus_Number):
    Y_po[i, i] = -np.sum(Y_po[i, :])
    Y_pv[i, i] = -np.sum(Y_pv[i, :])
    Y_qo[i, i] = -np.sum(Y_qo[i, :])
    Y_qv[i, i] = -np.sum(Y_qv[i, :])

# 燃气轮机和储能系统参数
N_DG_units = 2  # 燃气轮机数量
N_ESS = 1  # 储能系统数量
DG_con_SN = [2, 2]  # 燃气轮机额定容量
Pcon_max = [DG_con_SN[0], DG_con_SN[1]]  # 最大有功出力
Qcon_max = [DG_con_SN[0], DG_con_SN[1]]  # 最大无功出力
Qcon_min = [-DG_con_SN[0], -DG_con_SN[1]]  # 最小无功出力
Pcon_min = [0.5, 0.5]  # 最小有功出力
a_con = [3.0, 4.2]  # 成本系数a
b_con = [38.0, 44.5]  # 成本系数b
c_con = [3.4, 3.0]  # 成本系数c
Pcon_ramp_max = [x * 0.5 for x in Pcon_max]  # 爬坡率限制

# 系统运行约束
DN_Buy_P_limit = 2  # 购电有功功率限制
DN_Buy_Q_limit = 2  # 购电无功功率限制
Bus_V_min = 0.90  # 最小电压限制
Bus_V_max = 1.10  # 最大电压限制
Pij_limit = 5 * np.ones((Bus_Number, Bus_Number))  # 线路有功功率限制
Qij_limit = 5 * np.ones((Bus_Number, Bus_Number))  # 线路无功功率限制

# 分段线性化参数
e_matrix = np.array([[1, -2.413], [1, -0.414], [1, 0.414], [1, 0.414], [1, 2.413], 
                     [-1, -2.413], [-1, -0.414], [-1, 0.414], [-1, 2.413]])
f_matrix = [2.413, 1, 1, 2.413, 2.413, 1, 1, 2.413]

# 电价数据(24小时)
E_Price24 = [17.1500000000000, 17.0500000000000, 16.8100000000000, 16.4500000000000, 16.7300000000000,
             17.9800000000000, 21.7000000000000, 24.5700000000000, 25.3700000000000, 25.4800000000000,
             25.7200000000000, 25.4500000000000, 25.3700000000000, 24.7800000000000, 23.2800000000000,
             21.7900000000000, 21.8600000000000, 22.7100000000000, 22.4200000000000, 23.0700000000000,
             25.0900000000000, 22.9300000000000, 20.0800000000000, 17.4700000000000] * 4

# 负荷、风电、光伏出力曲线(标幺值)
P_Eload_pu24 = [0.743328944570461,0.718979437229693,0.703139499950969,0.693885339211632,0.693772971194200,0.714826243184869,0.755159592611612,0.802343208670403,0.860584236936171,0.895732411666777,0.919298158101092,0.919513958108114,0.898356897804618,0.903877817197369,0.904083670284032,0.910705585685043,0.926341212197781,0.931929831695530,0.926751193522105,0.920173208933502,0.920942372377349,0.901504584355280,0.844052453552627,0.792007424815461,
0.778296822402478,0.755956957942586,0.741520740541503,0.734569764919433,0.735537216057622,0.754852941939852,0.794104120847552,0.840612770265608,0.892021174884466,0.918456609149947,0.930870640948947,0.922549905118326,0.893493469812768,0.894153361989562,0.890032709292895,0.898546961700546,0.924756440305177,0.949122713482444,0.944879376473694,0.937230711240010,0.941467101240934,0.917395710466763,0.862755884577896,0.815902749062918,
0.833411141306049,0.812671690755246,0.799936393415542,0.793352446683596,0.796336426265647,0.816640250054899,0.860854372235197,0.910358201847669,0.955200399068455,0.971647954986320,0.973342794035355,0.956673189912070,0.919470061434761,0.920207308171023,0.914873552669640,0.926196708392959,0.961182706757109,0.999099283048914,0.998196203624238,0.990331983078185,0.999945679733319,0.973892023396757,0.919232592757127,0.873586652968263,
0.665989454717409,0.646654536501604,0.634642365276186,0.628751169739912,0.631313698767053,0.652407393584124,0.691731881366754,0.728296260400677,0.765924825968075,0.783390750875758,0.795816418654214,0.787841541822209,0.759561554069086,0.764769019920191,0.765370320411678,0.774008258298914,0.793804355234759,0.808528255061517,0.815035580220713,0.813524148012849,0.812165033787225,0.794084997201963,0.743994976499288,0.700586629035500]

P_Wind_pu24 = [0.367192596420284,0.346115562810715,0.325159114415535,0.308623555737261,0.291036336942036,0.272443269172590,0.247640716062870,0.215723964474746,0.196156393218061,0.196424553395612,0.202825799356433,0.210709282167795,0.230484783919353,0.260867283533209,0.294931275270982,0.322478791885351,0.337923971696090,0.349192521804687,0.355473913922539,0.379079968024166,0.409641527844994,0.427060124066476,0.431992872911694,0.433908050587748,
0.535780450739819,0.528228372418664,0.513922439204965,0.499675817218929,0.488610226317348,0.475610444702514,0.460629179695369,0.443140709180674,0.427631590885766,0.412446925346078,0.410399497136579,0.421097720713163,0.441212648845634,0.462447020306922,0.478167284231396,0.484280247189562,0.480448451745750,0.489363474914589,0.500006316199029,0.503101418185147,0.506942315004349,0.517213697915630,0.517302847694514,0.517162291548174,
0.964463953170727,0.964301467661140,0.971881692005958,0.981357591016865,0.984157507936570,0.981805617362991,0.976092859195109,0.971493797233701,0.944865743846117,0.894375751794254,0.874303741442369,0.882436642761092,0.896708439903169,0.906985061746451,0.920393785697014,0.943763496820944,0.967584780607908,0.990293795440722,0.999366118601442,0.999451548066926,1.00006251489827,0.997848419615594,0.991006729790127,0.979498996864742,
0.771308649178368,0.774327799152514,0.777243243803706,0.784446026183501,0.782066816252118,0.777295399630038,0.765023450132633,0.732733495697374,0.712268093174887,0.735749967988413,0.772200465138399,0.811224682791368,0.850954351954384,0.879027175086773,0.900648997494323,0.920196244766346,0.930358628987655,0.919222405506117,0.892001564110412,0.851882564084422,0.811181838222937,0.784241358769861,0.763707555700948,0.753066710149006]

P_PV_pu24 = [0.000246609751435038,0.000248450946775893,0.000248399498763841,0.000249316722794134,0.000248670233384641,0.00723408501397510,0.0621928160401500,0.234061219472568,0.497097204199897,0.749499268962421,0.912965571816002,0.996509081013825,0.999954564064567,0.947315716395799,0.834299843330501,0.659135371464226,0.432249969429947,0.196553782489059,0.0524787324276500,0.00639183738678103,0.000619545020385686,0.000368541852373165,0.000271747212638920,0.000268184305045309,
0.000180599596881865,0.000180691503655802,0.000180361918810045,0.000180383106898647,0.000180060022943712,0.00349126984474899,0.0249173845743947,0.0821778885143541,0.212785078897608,0.393107630032653,0.526533209640061,0.591911697966033,0.596835187185100,0.567933263641234,0.490691799777226,0.353502023391330,0.175926027565564,0.0679888857102506,0.0203255521278600,0.00308580543185550,0.000429610578800545,0.000304616368755321,0.000260801018149626,0.000250357113469873,
0.000248011128670850,0.000247918638288448,0.000247964858387304,0.000248159574981835,0.000247702944493784,0.000853786297844552,0.00669775261828288,0.0403112966776673,0.227025973763246,0.518474532032379,0.685410116100155,0.762138626782030,0.774046590379159,0.733144512864345,0.641782959770999,0.454371820721393,0.184960897489237,0.0453843223381480,0.00627499644422406,0.000847355180093882,0.000162706340638249,0.000104559047411636,9.15084687713078e-05,9.13432105894027e-05,
0.000178112270181690,0.000163221005393224,0.000159108405579472,0.000159447071331150,0.000160183411376603,0.00504574881177423,0.0514091425218062,0.238441726755216,0.522970769897627,0.758318647570983,0.896614540050506,0.952835823163475,0.940910117634692,0.890258090282033,0.795758039802389,0.643851434137400,0.418695635361550,0.168560280638749,0.0342357640114542,0.00302018763148175,0.000508760143835456,0.000285899210221312,0.000196100797284490,0.000192067975119560]

# 预定义时间参数
N_time = 24  # 调度周期
Bus_load_P_MW24 = np.zeros((Bus_Number, N_time*4))  # 24小时负荷有功功率
Bus_load_Q_MW24 = np.zeros((Bus_Number, N_time*4))  # 24小时负荷无功功率

# 计算24小时负荷曲线
for i in range(Bus_Number):
    for t in range(N_time*4):
        Bus_load_P_MW24[i, t] = bus[i, 2] * 1 * P_Eload_pu24[t]
        Bus_load_Q_MW24[i, t] = bus[i, 3] * 1 * P_Eload_pu24[t]
    P_Wind_24 = 1 * P_Wind_pu24
    P_PV_24 = 1 * P_PV_pu24

# 储能系统参数
    # Parameter for gas turbine and reserve
    N_DG_units = 2  # number of the gas turbine
    N_ESS = 1  # number of the ESS
    DG_con_SN = [2, 2]
    Pcon_max = [DG_con_SN[0], DG_con_SN[1]]
    Qcon_max = [DG_con_SN[0], DG_con_SN[1]]
    Qcon_min = [-DG_con_SN[0], -DG_con_SN[1]]
    Pcon_min = [0.5, 0.5]
    a_con = [3.0, 4.2]
    b_con = [38.0, 44.5]
    c_con = [3.4, 3.0]
    Pcon_ramp_max = [x * 0.5 for x in Pcon_max]  # Pcon_max .* 0.5
    DN_Buy_P_limit = 2
    DN_Buy_Q_limit = 2
    Bus_V_min = 0.90
    Bus_V_max = 1.10
    Pij_limit = 5 * np.ones((Bus_Number, Bus_Number))
    Qij_limit = 5 * np.ones((Bus_Number, Bus_Number))
    e_matrix = np.array(
        [[1, - 2.413], [1, - 0.414], [1, 0.414], [1, 0.414], [1, 2.413], [-1, - 2.413], [-1, - 0.414], [-1, 0.414],
         [-1, 2.413]])
    f_matrix = [2.413, 1, 1, 2.413, 2.413, 1, 1, 2.413]
    E_Price24 = [17.1500000000000, 17.0500000000000, 16.8100000000000, 16.4500000000000, 16.7300000000000,
                 17.9800000000000, 21.7000000000000, 24.5700000000000, 25.3700000000000, 25.4800000000000,
                 25.7200000000000, 25.4500000000000, 25.3700000000000, 24.7800000000000, 23.2800000000000,
                 21.7900000000000, 21.8600000000000, 22.7100000000000, 22.4200000000000, 23.0700000000000,
                 25.0900000000000, 22.9300000000000, 20.0800000000000, 17.4700000000000,
                 17.1500000000000, 17.0500000000000, 16.8100000000000, 16.4500000000000, 16.7300000000000,
                 17.9800000000000, 21.7000000000000, 24.5700000000000, 25.3700000000000, 25.4800000000000,
                 25.7200000000000, 25.4500000000000, 25.3700000000000, 24.7800000000000, 23.2800000000000,
                 21.7900000000000, 21.8600000000000, 22.7100000000000, 22.4200000000000, 23.0700000000000,
                 25.0900000000000, 22.9300000000000, 20.0800000000000, 17.4700000000000,
                 17.1500000000000, 17.0500000000000, 16.8100000000000, 16.4500000000000, 16.7300000000000,
                 17.9800000000000, 21.7000000000000, 24.5700000000000, 25.3700000000000, 25.4800000000000,
                 25.7200000000000, 25.4500000000000, 25.3700000000000, 24.7800000000000, 23.2800000000000,
                 21.7900000000000, 21.8600000000000, 22.7100000000000, 22.4200000000000, 23.0700000000000,
                 25.0900000000000, 22.9300000000000, 20.0800000000000, 17.4700000000000,
                 17.1500000000000, 17.0500000000000, 16.8100000000000, 16.4500000000000, 16.7300000000000,
                 17.9800000000000, 21.7000000000000, 24.5700000000000, 25.3700000000000, 25.4800000000000,
                 25.7200000000000, 25.4500000000000, 25.3700000000000, 24.7800000000000, 23.2800000000000,
                 21.7900000000000, 21.8600000000000, 22.7100000000000, 22.4200000000000, 23.0700000000000,
                 25.0900000000000, 22.9300000000000, 20.0800000000000, 17.4700000000000]
    P_Eload_pu24 = [0.743328944570461,0.718979437229693,0.703139499950969,0.693885339211632,0.693772971194200,0.714826243184869,0.755159592611612,0.802343208670403,0.860584236936171,0.895732411666777,0.919298158101092,0.919513958108114,0.898356897804618,0.903877817197369,0.904083670284032,0.910705585685043,0.926341212197781,0.931929831695530,0.926751193522105,0.920173208933502,0.920942372377349,0.901504584355280,0.844052453552627,0.792007424815461,
0.778296822402478,0.755956957942586,0.741520740541503,0.734569764919433,0.735537216057622,0.754852941939852,0.794104120847552,0.840612770265608,0.892021174884466,0.918456609149947,0.930870640948947,0.922549905118326,0.893493469812768,0.894153361989562,0.890032709292895,0.898546961700546,0.924756440305177,0.949122713482444,0.944879376473694,0.937230711240010,0.941467101240934,0.917395710466763,0.862755884577896,0.815902749062918,
0.833411141306049,0.812671690755246,0.799936393415542,0.793352446683596,0.796336426265647,0.816640250054899,0.860854372235197,0.910358201847669,0.955200399068455,0.971647954986320,0.973342794035355,0.956673189912070,0.919470061434761,0.920207308171023,0.914873552669640,0.926196708392959,0.961182706757109,0.999099283048914,0.998196203624238,0.990331983078185,0.999945679733319,0.973892023396757,0.919232592757127,0.873586652968263,
0.665989454717409,0.646654536501604,0.634642365276186,0.628751169739912,0.631313698767053,0.652407393584124,0.691731881366754,0.728296260400677,0.765924825968075,0.783390750875758,0.795816418654214,0.787841541822209,0.759561554069086,0.764769019920191,0.765370320411678,0.774008258298914,0.793804355234759,0.808528255061517,0.815035580220713,0.813524148012849,0.812165033787225,0.794084997201963,0.743994976499288,0.700586629035500]
    P_Wind_pu24 = [0.367192596420284,0.346115562810715,0.325159114415535,0.308623555737261,0.291036336942036,0.272443269172590,0.247640716062870,0.215723964474746,0.196156393218061,0.196424553395612,0.202825799356433,0.210709282167795,0.230484783919353,0.260867283533209,0.294931275270982,0.322478791885351,0.337923971696090,0.349192521804687,0.355473913922539,0.379079968024166,0.409641527844994,0.427060124066476,0.431992872911694,0.433908050587748,
0.535780450739819,0.528228372418664,0.513922439204965,0.499675817218929,0.488610226317348,0.475610444702514,0.460629179695369,0.443140709180674,0.427631590885766,0.412446925346078,0.410399497136579,0.421097720713163,0.441212648845634,0.462447020306922,0.478167284231396,0.484280247189562,0.480448451745750,0.489363474914589,0.500006316199029,0.503101418185147,0.506942315004349,0.517213697915630,0.517302847694514,0.517162291548174,
0.964463953170727,0.964301467661140,0.971881692005958,0.981357591016865,0.984157507936570,0.981805617362991,0.976092859195109,0.971493797233701,0.944865743846117,0.894375751794254,0.874303741442369,0.882436642761092,0.896708439903169,0.906985061746451,0.920393785697014,0.943763496820944,0.967584780607908,0.990293795440722,0.999366118601442,0.999451548066926,1.00006251489827,0.997848419615594,0.991006729790127,0.979498996864742,
0.771308649178368,0.774327799152514,0.777243243803706,0.784446026183501,0.782066816252118,0.777295399630038,0.765023450132633,0.732733495697374,0.712268093174887,0.735749967988413,0.772200465138399,0.811224682791368,0.850954351954384,0.879027175086773,0.900648997494323,0.920196244766346,0.930358628987655,0.919222405506117,0.892001564110412,0.851882564084422,0.811181838222937,0.784241358769861,0.763707555700948,0.753066710149006]
    P_PV_pu24 = [0.000246609751435038,0.000248450946775893,0.000248399498763841,0.000249316722794134,0.000248670233384641,0.00723408501397510,0.0621928160401500,0.234061219472568,0.497097204199897,0.749499268962421,0.912965571816002,0.996509081013825,0.999954564064567,0.947315716395799,0.834299843330501,0.659135371464226,0.432249969429947,0.196553782489059,0.0524787324276500,0.00639183738678103,0.000619545020385686,0.000368541852373165,0.000271747212638920,0.000268184305045309,
0.000180599596881865,0.000180691503655802,0.000180361918810045,0.000180383106898647,0.000180060022943712,0.00349126984474899,0.0249173845743947,0.0821778885143541,0.212785078897608,0.393107630032653,0.526533209640061,0.591911697966033,0.596835187185100,0.567933263641234,0.490691799777226,0.353502023391330,0.175926027565564,0.0679888857102506,0.0203255521278600,0.00308580543185550,0.000429610578800545,0.000304616368755321,0.000260801018149626,0.000250357113469873,
0.000248011128670850,0.000247918638288448,0.000247964858387304,0.000248159574981835,0.000247702944493784,0.000853786297844552,0.00669775261828288,0.0403112966776673,0.227025973763246,0.518474532032379,0.685410116100155,0.762138626782030,0.774046590379159,0.733144512864345,0.641782959770999,0.454371820721393,0.184960897489237,0.0453843223381480,0.00627499644422406,0.000847355180093882,0.000162706340638249,0.000104559047411636,9.15084687713078e-05,9.13432105894027e-05,
0.000178112270181690,0.000163221005393224,0.000159108405579472,0.000159447071331150,0.000160183411376603,0.00504574881177423,0.0514091425218062,0.238441726755216,0.522970769897627,0.758318647570983,0.896614540050506,0.952835823163475,0.940910117634692,0.890258090282033,0.795758039802389,0.643851434137400,0.418695635361550,0.168560280638749,0.0342357640114542,0.00302018763148175,0.000508760143835456,0.000285899210221312,0.000196100797284490,0.000192067975119560]

    # Pre-defined parameters
    N_time = 24
    Bus_load_P_MW24 = np.zeros((Bus_Number, N_time*4))
    Bus_load_Q_MW24 = np.zeros((Bus_Number, N_time*4))
    for i in range(Bus_Number):
        for t in range(N_time*4):
            Bus_load_P_MW24[i, t] = bus[i, 2] * 1 * P_Eload_pu24[t]
            Bus_load_Q_MW24[i, t] = bus[i, 3] * 1 * P_Eload_pu24[t]
        P_Wind_24 = 1 * P_Wind_pu24
        P_PV_24 = 1 * P_PV_pu24

# Parameters for reserve
SOC0 = 2.5
SOC_max = 5
ESS_P_max = 3  # Max charge/discharge power
Laimuta = 0.995
Yita = 0.95  # Efficiency of charge/discharge
